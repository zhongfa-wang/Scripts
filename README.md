# How to run

We've got two tasks: build and run. Implementation of the former is in `build.sh` and that of the latter in `run.sh`. In order to run each task for different benchmarks and versions simultaneously, we use GNU `parallel`. The input of `parallel` is generated by `print_commands.sh`.

First we list all the commands and redirect to a file (let us name it `commands` here).

```bash
% bash ./print_commands.sh [build|run] [num_copies] > commands
```

You select either build or run in the first argument. The second `num_copies` specify how many copies you want for each configuration (probably we want more copies for configurations with less percentage of branches protected, but currently we use a universal number for all configurations). The default value is 10.

Next the `commands` file is fed into `parallel` in the following manner to be executed in parallel.

```bash
% nice -n N taskset -c 0-63 parallel -j P < commands
```

N specifies the niceness and P the number of processors. The `taskset` is meant to prohibit the use of sibling SMT cores for a certain server system we have (not sure if the mappings are identical in containers so you need to make sure if you run in such environments). Please make sure to use the appropriate N value for the P you specify (N=0 if P=32, N=3 if P=64 etc).
